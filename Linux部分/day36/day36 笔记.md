

# day36 ç¬”è®°

 

### Ep01 è¿›ç¨‹é—´é€šä¿¡å¤ä¹ 

- ç®¡é“

  > - æµç®¡é“
  >   - è¾“å…¥è¾“å‡ºæµé‡å®šå‘
  > - æ— åç®¡é“
  >   - åªèƒ½åœ¨æœ‰äº²ç¼˜å…³ç³»çš„è¿›ç¨‹é—´ä½¿ç”¨ï¼ˆçˆ¶å­/å…„å¼Ÿï¼‰
  >   - åŠåŒå·¥ï¼Œæœ‰å›ºå®šçš„è¯»ç«¯(fds[0])å’Œå†™ç«¯(fds[1])
  >   - æ˜¯ç‰¹æ®Šçš„æ–‡ä»¶ï¼Œå¯ä»¥ç”¨readï¼Œwriteè¯»å†™ç®¡é“ï¼Œç¨‹åºç»“æŸåæ¶ˆå¤±
  >   - å…ˆå…³é—­ç®¡é“è¯»ç«¯å†å†™ç®¡é“æ—¶ï¼Œå†™ç®¡é“çš„è¿›ç¨‹ä¼šæ”¶åˆ°SIGPIPEä¿¡å·ï¼Œå¯¼è‡´è¿›ç¨‹ç»ˆæ­¢
  > - å‘½åç®¡é“
  >   - åˆ›é€ ç®¡é“æ–‡ä»¶ï¼Œæ–‡ä»¶ä¼šä¸€ç›´å­˜åœ¨ï¼Œä¸ä¼šéšè¿›ç¨‹ç»“æŸè€Œæ¶ˆå¤±

- å…±äº«å†…å­˜

  > - åˆ›å»ºå…±äº«å†…å­˜ï¼š`int shmget(key,size,flags)`
  > - å°†å…±äº«å†…å­˜æ˜ å°„åˆ°è¿›ç¨‹çš„åœ°å€ç©ºé—´`void *shmat(shmid,NULL,0)`
  > - è§£é™¤æ˜ å°„`int shmdt(const void *addr)`
  > - æ§åˆ¶å…±äº«å†…å­˜ï¼š`shmctl();`
  >   - IPC_RMIDï¼šåˆ é™¤å…±äº«å†…å­˜
  >   - IPC_STATï¼šè·å–å…±äº«å†…å­˜ä¿¡æ¯
  >   - IPC_SETï¼šä¿®æ”¹å…±äº«å†…å­˜ä¿¡æ¯
  > - å‘½ä»¤ï¼š
  >   - `ipcs`ï¼šæŸ¥çœ‹åˆ›å»ºçš„å…±äº«å†…å­˜
  >   - `ipcrm -m shmid`ï¼šåˆ é™¤å…±äº«å†…å­˜
  >   - shmidä¸ºå…±äº«å†…å­˜id
  >   - å…±äº«å†…å­˜çš„åˆ é™¤æ˜¯æ ‡è®°åˆ é™¤ï¼Œåªæœ‰å½“æœ€åè¿æ¥å…±äº«å†…å­˜çš„è¿›ç¨‹è§£é™¤æ˜ å°„ä¹‹åï¼Œæ‰ä¼šçœŸæ­£çš„åˆ é™¤è¿™æ®µå…±äº«è¿›ç¨‹
  > - è¿›ç¨‹è™šæ‹Ÿåœ°å€åˆ°ç‰©ç†åœ°å€çš„è½¬æ¢ï¼šå¤šæ•°ä¸ºå†™æ—¶å¤åˆ¶
  >   - é¡µç›®å½•>>é¡µè¡¨é¡¹>>é¡µå†…åç§»ï¼ˆå¯¹äº32ä½ç³»ç»Ÿä»…æœ‰3çº§ï¼‰
  >   - TLBï¼šå¿«è¡¨ï¼ŒåŠ å¿«æ˜ å°„é€Ÿåº¦
  >     - æœ¬è´¨æ˜¯å› ä¸ºcpué€Ÿåº¦å’Œå†…å­˜é€Ÿåº¦å·®åˆ«è¿‡å¤§
  >     - å°†é¢‘ç¹è®¿é—®çš„æ•°æ®å­˜å…¥TLBï¼ˆé€Ÿåº¦å’Œcpuå·®ä¸å¤šï¼‰ä¸­ï¼Œä¸é€ æˆcpuæ—¶é—´ç‰‡çš„æµªè´¹
  >   - å½“è™šæ‹Ÿé¡µå’Œç‰©ç†é¡µçš„æ˜ å°„å…³ç³»æ²¡æœ‰å»ºç«‹ï¼Œå¹¶ä¸”è¦è®¿é—®è¿™æ®µå†…å­˜æ—¶ï¼Œä¼šå‘ç”Ÿç¼ºé¡µå¼‚å¸¸ï¼Œéœ€è¦è°ƒé¡µã€‚
  >   - å»ºç«‹æ˜ å°„å…³ç³»ï¼Œå¯ä»¥é€šè¿‡ä½¿ç”¨å¤§é¡µï¼Œå‡å°‘ç¼ºé¡µå¼‚å¸¸ã€‚
  > - mmapæ–¹å¼å®ç°å…±äº«å†…å­˜
  >   - MAP_SHARED
  >   - é€Ÿåº¦å¿«ï¼Œå¯ä»¥å¤šå¯¹å¤š
  >   - ç”¨æ³•ç±»ä¼¼é€šå‘Šç‰ˆ

- ä¿¡å·é‡

  > - åˆ†ç±»ï¼ˆä¸€ä¸ªä¸å¤šä¸ªï¼‰
  >   - å•ä¸ªä¿¡å·é‡ï¼šå¯ä»¥çœ‹ä½œæ˜¯äºŒè¿›åˆ¶å¼€å…³ï¼šç›¸å½“äºé”
  >     - å¯¹åŒä¸€ä¸ªæ•°å„åŠ ä¸€åƒä¸‡
  >     - è‹¥ä¸åŠ é”åˆ™ä¼šä¸¤ä¸ªè¿›ç¨‹ç«äº‰å¯¼è‡´æ‰€å¾—æ•°å°äºä¸¤åƒä¸‡
  >   - å¤šä¸ªä¿¡å·é‡ï¼šè®¡æ•°ä¿¡å·é‡â†’ä¿¡å·é‡çš„å€¼ä»£è¡¨èµ„æºæ•°é‡ï¼Œé™åˆ¶èµ„æºå¯ä»¥è¢«å¤šå°‘è¿›ç¨‹è®¿é—®
  > - åˆ›å»º/è·å–ä¿¡å·é‡é›†åˆï¼šint semget
  > - semopï¼šæ”¹å˜ä¿¡å·é‡çŠ¶æ€
  >   - Pæ“ä½œï¼šå¯¹ä¿¡å·é‡-1ï¼Œé‡Šæ”¾èµ„æº æœ¬è´¨å¯ä»¥çœ‹ä½œåŠ é”
  >   - Væ“ä½œï¼šå¯¹ä¿¡å·é‡+1  æœ¬è´¨å¯ä»¥çœ‹ä½œè§£é”
  > - semctlï¼šä¿¡å·é‡çš„æ§åˆ¶
  >   - SETVALï¼šè®¾ç½®å•ä¸ªä¿¡å·é‡çš„å€¼
  >   - SETALLï¼šè®¾ç½®å…¨éƒ¨ä¿¡å·é‡çš„å€¼ï¼ˆæ­¤æ—¶éœ€è¦ä¸€ä¸ªæŒ‡é’ˆç±»å‹å­˜å‚¨è®¾ç½®å€¼ï¼‰
  >   - GETVALï¼šå¾—åˆ°å•ä¸ªä¿¡å·çš„å€¼
  >   - GETALLï¼šå¾—åˆ°æ‰€æœ‰ä¿¡å·çš„å€¼ï¼ˆæ­¤æ—¶éœ€è¦ä¸€ä¸ªæŒ‡é’ˆç±»å‹å­˜å‚¨è·å¾—å€¼ï¼‰
  >   - IPC_RMIDï¼šåˆ é™¤ä¿¡å·é‡çš„å€¼

- æ¶ˆæ¯é˜Ÿåˆ—

  > - æ¶ˆæ¯é˜Ÿåˆ—çš„åˆ›å»ºï¼š`int msget(key,flag);`
  >
  > - æ·»åŠ æ¶ˆæ¯ï¼š`int msgsnd(msgid,msgp,size,flag);`
  >
  > - è·å–æ¶ˆæ¯ï¼š`int msgrcv(msgic,msgp,size,msgtype,flag);`(å¯é€‰NOWAITå‚æ•°ï¼Œå³ä¸ç­‰å¾…ç›´æ¥è¯»å–)
  >
  >   - flsgå‚æ•°ï¼šå¸¸ç”¨ä¸º0ï¼Œæˆ–è€…IPC_NOWAITï¼Œè‹¥æ­¤æ—¶é˜Ÿåˆ—æ»¡å†è°ƒç”¨msgsndæˆ–è€…é˜Ÿåˆ—ç©ºçš„æ˜¯hiè°ƒç”¨msgrcvå°†ç›´æ¥è¿”å›é”™è¯¯
  >
  >   - msgpä¸ºä¸€ä¸ªå¯å˜é•¿åº¦ç»“æ„ä½“ï¼ŒåŸå‹ä¸º
  >
  >     ```c
  >     struct msgbuf{
  >         long mtype;
  >         char mtext[64];
  >         //æ­¤å¤„ä»…å¯ä»¥è‡ªå®šä¹‰å¤§å°
  >     };
  >     ```
  >
  >   - æ¶ˆæ¯ç±»å‹ï¼šå³msgtypeçš„ä¸‰ç§é€‰é¡¹
  >
  >   - msgtype = 0ï¼šæ¥å—ä¿¡å·é˜Ÿåˆ—ä¸­çš„ç¬¬ä¸€ä¸ªä¿¡æ¯
  >
  >   - msgtype ï¼0ï¼šæ¥å—æŒ‡å®šåºåˆ—å·çš„ç¬¬ä¸€ä¸ªæ¶ˆæ¯
  >
  >   - msgtype ï¼œ 0ï¼šæ¥å—ç±»å‹å°äºç­‰äºmsgtypeç»å¯¹å€¼çš„ç¬¬ä¸€ä¸ªæœ€ä½ç±»å‹æ¶ˆæ¯
  >
  >   - æ¶ˆæ¯é˜Ÿåˆ—ç¼–å·ä¸­ï¼Œæ— 0å·é˜Ÿåˆ—
  >
  > - æ¶ˆæ¯é˜Ÿåˆ—æ§åˆ¶å‡½æ•°ï¼š`int msgctl(msgid,cmd,buf);`
  >
  >   - å…¶ä¸­cmdå¸¸ç”¨ä¸ºï¼šIPC_RMID
  >   - è¡¨ç¤ºåˆ é™¤æ¶ˆæ¯é˜Ÿåˆ—
  >   - bufå¸¸ç”¨NULL
  >
  > - ç‰¹ç‚¹ï¼šä½¿ç”¨æ–¹ä¾¿ï¼Œçµæ´»ï¼Œå°†ä»»åŠ¡å¼‚æ­¥è¿è¡Œ

- ä¿¡å·

  > - 

### Ep02 sigactionå¤„ç†ä¿¡å·

- åŸå‹

  > - å‡½æ•°åŸå‹
  >
  >   ```c
  >   #include<signal.h>
  >   int sigaction(int signum,const struct sigaction *act,struct sigaction *oldact);
  >   ```
  >
  > - signumï¼šä¸ºä¸€ä¸ªéœ€è¦æ•æ‰çš„ä¿¡å·
  >
  > - actæ˜¯ä¸€ä¸ªç»“æ„ä½“
  >
  > - oldactæ˜¯ä¸€ä¸ªä¼ å‡ºå‚æ•°ï¼Œå‡½æ•°è°ƒç”¨æˆåŠŸä¹‹åï¼Œoldacté‡Œé¢åŒ…å«ä»¥å‰å¯¹signumçš„å¤„ç†æ–¹æ³•ï¼Œé€šå¸¸ä¸ºNULL
  >
  > - è°ƒç”¨æˆåŠŸåˆ™ä¸º0ï¼Œå¤±è´¥åˆ™ä¸º-1
  >
  > - `struct sigactionç»“æ„ä½“`
  >
  >   ```c
  >   struct sigaction{
  >   	void(*sa_handler)(int);
  >       //è€ç±»å‹çš„ä¿¡å·å¤„ç†æŒ‡é’ˆ
  >       void(*sa_sigaction)(int,siginfo_t *,void*);
  >       //æ–°ç±»å‹çš„ä¿¡å·å¤„ç†æŒ‡é’ˆ
  >       sigset_t sa_mask;
  >       //å°†è¦è¢«é˜»å¡çš„ä¿¡å·é›†åˆ
  >       int sa_flags;
  >       //ä¿¡å·å¤„ç†æ–¹å¼æ©ç ğŸ‘‰SA_SIGINFO
  >       void(*sa_restorer)(void);
  >       //ä¿ç•™ ä¸è¦ä½¿ç”¨
  >   };
  >   ```
  >
  > - ä»£ç å®ç°
  >
  > - ```c
  >   void sigFunc(int signum,siginfo_t* pINfo,void *p)
  >   {
  >       printf("%d is coming\n",signum);
  >   }
  >   int main()
  >   {
  >       struct signation act;
  >       bzero(&act,sizeof(act));
  >       
  >       act.sa_falgs = SA_SIGINFO;
  >       act.sa_sigaction = sigFunc;
  >       int ret;
  >       ret = sigaction(SIGINT,&act,NULL);
  >       ERROR_CHECK(ret.-1,"sigaction Error");
  >       while(1);
  >       return 0;
  >   }
  > ```
  >   
  >   â€‹	![image-20200425161957602](day36 ç¬”è®°.assets/image-20200425161957602.png)
  >   

- sigactionçš„ä¿¡å·å¤„ç†æœºåˆ¶

  > - ä¼ å…¥å‚æ•°ï¼šä¼ ç»™å‚æ•°ï¼Œå‡½æ•°å†…éƒ¨åªèƒ½ç”¨ï¼Œä¸èƒ½ä¿®æ”¹
  >
  > - ä¼ å‡ºå‚æ•°ï¼šä¼ ç»™å‡½æ•°æ—¶æ˜¯ç©ºç™½çš„ï¼Œå‡½æ•°å†…éƒ¨åšä¿®æ”¹ï¼Œå‡½æ•°å¤–éƒ¨å°±å¯ä»¥æ‹¿åˆ°ä¿®æ”¹çš„å€¼
  >
  > - ä¼ å…¥ä¼ å‡ºå‚æ•°ï¼šä¼ ç»™å‡½æ•°çš„å€¼ï¼Œå‡½æ•°å†…éƒ¨åšä¿®æ”¹ï¼Œå‡½æ•°å¤–éƒ¨å°±å¯ä»¥æ‹¿åˆ°ä¿®æ”¹çš„å€¼
  >
  > - ä¸­æ–­ä¼˜å…ˆçº§ï¼Œä¸­æ–­åµŒå¥—ã€‚
  >
  >   - è¿›ç¨‹å†ä¿¡å·å¤„ç†å‡½æ•°ä¸­ï¼Œå†æ¥ä¸€ä¸ªç›¸åŒä¿¡å·ï¼Œä¼šå…ˆæ‰§è¡Œå®Œå½“å‰ä¿¡å·å¤„ç†å‡½æ•°ï¼Œå†å»å“åº”æ–°åˆ°çš„åŒç±»ä¿¡å·ã€‚	
  >   - è¿›ç¨‹å†ä¿¡å·å¤„ç†å‡½æ•°ä¸­ï¼Œå†æ¥ä¸€ä¸ªä¸åŒä¿¡å·ï¼Œåˆ™ä¼šç›¸åº”æ–°çš„ä¿¡å·ã€‚
  >   - ç”¨sigactionå’Œsignalæ³¨å†Œä¿¡å·æ•ˆæœç›¸åŒ
  >
  > - ç»“æ„ä½“`stgset_t`è·Ÿ`fd_set`ç±»ä¼¼ï¼Œæ¯ä¸€ä½ä»£è¡¨ä¸€ä¸ªä¿¡å·ï¼Œå½“å¯¹åº”ä½æ˜¯0æ—¶åˆ™è¡¨ç¤ºæ— ä¿¡å·äº§ç”Ÿï¼Œæ˜¯1æ—¶åˆ™è¡¨ç¤ºæœ‰è¯¥ä¿¡å·äº§ç”Ÿ
  >
  > - è¿›ç¨‹é˜»å¡åœ¨ä¸€äº›ç³»ç»Ÿè°ƒç”¨ï¼Œæ¯”å¦‚readçš„æ—¶å€™ï¼Œæ­¤æ—¶æ¥äº†ä¸ªä¿¡å·ã€‚
  >
  >   - å¦‚æœæ˜¯`sigaction`æ³¨å†Œçš„ä¿¡å·ï¼Œä¼šä¼˜å…ˆå¤„ç†ä¿¡å·ï¼Œå¤„ç†å®Œä¿¡å·ä¹‹åï¼Œæ­£åœ¨é˜»å¡çš„ç³»ç»Ÿè°ƒç”¨ä¸ä¼šå†é˜»å¡ï¼Œè€Œæ˜¯ç›´æ¥è¿”å›-1
  >   - å¦‚æœæ˜¯`signal`æ³¨å†Œçš„ä¿¡å·ï¼Œä¹Ÿä¼šä¼˜å…ˆå¤„ç†ä¿¡å·ï¼Œä½†æ˜¯å¤„ç†å®Œä¿¡å·ä¹‹åï¼Œä¼šç»§ç»­ä¼šåˆ°ç³»ç»Ÿè°ƒç”¨ï¼Œç»§ç»­é˜»å¡ã€‚
  >   - å¯ä»¥ç”¨SA_RESTARå°†`sigaction`æ”¹æˆå’Œ`signal`ä¸€æ ·çš„è¡Œä¸º
  >
  > - å†ä¸€ä¸ªä¿¡å·è¢«é˜»å¡ä¹‹åï¼Œåœ¨è§£é™¤é˜»å¡ä¹‹å‰ï¼Œè¯¥ä¿¡å·å‘é€äº†å¤šæ¬¡ï¼Œä½†æ˜¯è§£é™¤é˜»å¡çš„æ—¶å€™ï¼Œå†…æ ¸åªä¼šå‘è¿›ç¨‹å‘é€ä¸€ä¸ªä¿¡å·ï¼Œè€Œä¸ç®¡åœ¨å…¶é˜»å¡æœŸé—´æœ‰å¤šå°‘ä¸ªä¿¡å·äº§ç”Ÿã€‚å› ä¸ºåœ¨Linuxä¸­ä¸ä¼šå¯¹ä¿¡å·è¿›è¡Œæ’é˜Ÿã€‚
  >
  > - sig_read
  >
  >   ```c
  >   void sigFunc(int signum,siginfo_t* pINfo,void *p)
  >   {
  >       printf("before sleep %d is coming\n",signum);
  >       sleep(3);
  >       printf("after sleep %d is coming\n",signum);  
  >   }
  >   int main()
  >   {
  >       if(signal(SIGINT,sigFunc) == SIG_ERR)
  >       {
  >           printf("signal failed\n");
  >           return -1;
  >       }
  >       signal(SIGINT,sigFunc);
  >       char buf[64] = {0};
  >       int ret;
  >       ret = read(0,buf,sizeof(buf));
  >       printf("ret = %d,buf = %s\n"ret,buf);
  >       
  >   }
  >   ```
  >
  > - `sig_two.c`
  >
  >   - ![image-20200423113136678](day36 ç¬”è®°.assets/image-20200423113136678.png)
  >   - æ‰§è¡Œæ•ˆæœ<img src="day36 ç¬”è®°.assets/image-20200425174305391.png" alt="image-20200425174305391" style="zoom:80%;" />
  >
  > - å½“ä¸€ä¸ªä¿¡å·è¢«é˜»å¡ä¹‹åï¼Œåœ¨è§£é™¤é˜»å¡ä¹‹å‰ï¼Œè¯¥ä¿¡å·å‘ç”Ÿäº†å¤šæ¬¡ï¼Œä½†æ˜¯è§£é™¤é˜»å¡çš„æ—¶å€™ï¼Œå†…æ ¸åªä¼šå‘è¿›ç¨‹å‘é€ä¸€ä¸ªä¿¡å·è€Œå·²ï¼Œè€Œä¸ç®¡åœ¨å…¶é˜»å¡æœŸé—´æœ‰å¤šå°‘ä¸ªä¿¡å·äº§ç”Ÿï¼Œå› ä¸ºlinuxå¹¶ä¸ä¼šå¯¹ä¿¡å·è¿›è¡Œæ’é˜Ÿã€‚
  >
  > - è¿™é‡Œç”¨åˆ°äº†æ‰“æ–­readè¾“å…¥çš„ä¸­æ–­å¤„ç†ï¼Œå¿…é¡»è¦åŠ å‚æ•°SA_RESTARTï¼Œå¯¹äºsignal å‡½æ•°è€Œè¨€ï¼Œå®ƒå®‰è£…çš„ä¿¡å·å¤„ç†å‡½æ•°ï¼Œç³»ç»Ÿé»˜è®¤ä¼šè‡ªåŠ¨é‡å¯è¢«ä¸­æ–­çš„ç³»ç»Ÿè°ƒç”¨ï¼Œè€Œä¸æ˜¯è®©å®ƒå‡ºé”™è¿”å›
  >
  > - å¯¹äºsigactionå‡½æ•°è€Œè¨€ï¼Œå¿…é¡»è¦è‡ªå·±æŒ‡å®šSA_RESTARTå®ç°é‡å¯åŠŸèƒ½ï¼Œå¦‚æœä¸æŒ‡å®šåˆ™ä¼šreadå¤±è´¥ï¼Œæç¤ºreadçš„æ—¶å€™ä¸­æ–­å‘ç”Ÿ
  >
  >   - å³æ¢å¤çš„æ—¶å€™readç›´æ¥è¿”å›-1



### Ep03 ä¿¡å·çš„é˜»å¡

- ä¿¡å·çš„åµŒå¥—ï¼š

  > - åœ¨ä¿¡å·æ‰§è¡Œè¿‡ç¨‹ä¸­ä¼ å…¥æ–°çš„ä¿¡å·ï¼Œä¼šç›´æ¥ä¸­æ–­ç›®å‰æ‰§è¡Œçš„ä¿¡å·ï¼Œæ‰§è¡Œæ–°çš„ä¿¡å·ï¼Œç­‰å¾…æ–°ä¿¡å·æ‰§è¡Œå®Œæ¯•ä¹‹åå†ç»§ç»­æ‰§è¡Œæ—§ä¿¡å·
  >
  > - æ­¤å¤„ç¨‹åº
  >
  >   - ```c
  >     
  >     ```
  >
  >   - 
  >
  >   - ![image-20200423143951592](day36 ç¬”è®°.assets/image-20200423143951592.png)

- sa_maskå‚æ•°

  > - å¯ä»¥åœ¨ä¿¡å·å¤„ç†å‡½æ•°å†…ä¸è¢«å…¶ä»–ä¿¡å·æ‰“æ–­
  >
  > - é€šè¿‡ä¿¡å·ï¼Œå¯ä»¥æ‰§è¡ŒæœåŠ¡ç¨‹åºï¼Œç»“æŸ/ä¸­æ–­è¿›ç¨‹ã€‚åœ¨æ‰§è¡Œä¸€äº›é‡è¦ç¨‹åºçš„æ—¶å€™ä¸ºäº†é˜²æ­¢è¢«ä¼ å…¥ä¿¡å·æ‰“æ–­ï¼Œéœ€è¦åŠ ä¸Šsa_maskå‚æ•°ã€‚é˜²æ­¢è¢«æ‰“æ–­
  >
  > - ![image-20200423150747101](day36 ç¬”è®°.assets/image-20200423150747101.png)
  >
  > - åœ¨å†…æ ¸ä¸­
  >
  > - 
  >
  > - ä»£ç å®ç°
  >
  >   ```c
  >   
  >   ```

- sigprocmask

  > - æ‰§è¡Œä¹‹å‰å…ˆç”¨blockåŠ é”ï¼Œæ‰§è¡Œå®Œæ¯•ä¹‹åç”¨unblockè§£é”
  >
  > - ![image-20200423152044760](day36 ç¬”è®°.assets/image-20200423152044760.png)
  >
  > - åœ¨ä¿¡å·å¤„ç†å‡½æ•°ä¹‹å†…ï¼Œä¸å¸Œæœ›è¢«æ‰“æ–­
  >
  >   - `sigprocmask.c`
  >
  >   ```c
  >   int main()
  >   {
  >       sigget_t mask;
  >       sigemptiset(&mask);
  >       sigaddset(&mask,SIGQUIT);
  >       sigprocmask(SIG_BLOCK,&mask,NULL);
  >       //å…³é”®ä»£ç 
  >       sleep(5);
  >       sigpromask(SIG_UNBLOCK,&mask,NULL);
  >       while(1);
  >   }
  >   ```
  >
  > - ![image-20200423160551368](day36 ç¬”è®°.assets/image-20200423160551368.png)

### Ep04 killå‘½ä»¤

- åŸå‹

  > - å‡½æ•°åŸå‹
  >
  >   ```c
  >   #include<sys/types.h>
  >   #include<signal.h>
  >   int kill(pid_t pid,int sig);
  >   ```
  >
  > - `pid`ä¸ºå°†è¦æ¥å—ä¿¡å·çš„è¿›ç¨‹pid
  >
  > - å¯ä»¥é€šè¿‡`getpid()`å‡½æ•°è¿˜ç»™è‡ªèº«å‘é€ä¿¡å·
  >
  > - è¿˜å¯ä»¥å‘é€ä¿¡å·ç»™æŒ‡å®šè¿›ç¨‹ï¼Œæ­¤æ—¶pidæœ‰
  >
  > - `pid` > 0ï¼šå°†ä¿¡å·å‘ç»™IDä¸ºpidçš„è¿›ç¨‹
  >
  > - `pid` == 0ï¼šå°†ä¿¡å·å‘é€ç»™ä¸å‘é€è¿›ç¨‹å±äºåŒä¸€ä¸ªè¿›ç¨‹ç»„çš„æ‰€æœ‰è¿›ç¨‹
  >
  > - `pid ` == -1ï¼šå°†ä¿¡å·å‘é€ç»™è¯¥è¿›ç¨‹æœ‰æƒé™å‘é€çš„ç³»ç»Ÿé‡Œçš„æ‰€æœ‰è¿›ç¨‹
  >
  > - `pid` < 0ï¼šå°†ä¿¡å·å‘é€ç»™è¿›ç¨‹ç»„IDç­‰äºpidç»å¯¹å€¼çš„æ‰€æœ‰è¿›ç¨‹
  >
  > - `sig` ä¸ºå°†è¦å‘é€çš„ä¿¡å·
  >
  > - æˆåŠŸåˆ™è¿”å›0ï¼Œå¤±è´¥åˆ™è¿”å›-1
  >
  > - ä»£ç å®ç°killå‘é€ä¿¡å·2ç»™çˆ¶å­è¿›ç¨‹
  >
  > - ```c
  >   int main()
  >   {
  >       if(fork())
  >       {
  >           while(1)
  >       }
  >       else
  >       {
  >       	int ret;
  >       	ret = kill(0,2);
  >       }
  >   }
  >   ```
  >
  > - ä¼ å‚çš„å½¢å¼å‘é€kill
  >
  >   - ```c
  >     int main(int argc,char*argv[])
  >     {
  >         int ret;
  >         ret = kill(argv[1],2);
  >         ERROR_CHECL(ret,-1,"kill Error");
  >         
  >     }
  >     ```

### Ep05è®¡æ—¶å™¨å’Œæ—¶é’Ÿå¤„ç†

- sleepåŸå‹

  > - ![image-20200423162514480](day36 ç¬”è®°.assets/image-20200423162514480.png)

- æ—¶é’Ÿå¤„ç†

  > - çœŸå®è®¡æ—¶å™¨ï¼šè®¡ç®—ç¨‹åºè¿è¡Œçš„çœŸå®æ—¶é—´
  >   - ä»ç¨‹åºå¼€å§‹åˆ°ç¨‹åºç»“æŸ
  > - è™šæ‹Ÿè®¡æ—¶å™¨ï¼šè®¡ç®—ç¨‹åºè¿è¡Œåœ¨ç”¨æˆ·æ€çš„æ—¶é—´
  > - ä½¿ç”¨è®¡æ—¶å™¨ï¼šç¨‹åºå¤„äºç”¨æˆ·æ€å’Œå¤„äºå†…æ ¸æ€æ‰€æ¶ˆè€—çš„æ—¶é—´å’Œ
  >
  > ![image-20200423164103743](day36 ç¬”è®°.assets/image-20200423164103743.png)

- è®¡æ•°å™¨ä½¿ç”¨ï¼š

  > - ![image-20200423164136936](day36 ç¬”è®°.assets/image-20200423164136936.png)
  >
  > - ```c
  >   void sigFunc()
  >   {
  >       
  >   }
  >   ```
  >
  > - ![image-20200423170729089](day36 ç¬”è®°.assets/image-20200423170729089.png)

  

  



### Ep06 Linuxå¤šçº¿ç¨‹

- è¿›ç¨‹çº¿ç¨‹çš„å¯¹æ¯”
- å„è‡ªä¼˜ç¼ºç‚¹
- çº¿ç¨‹åˆ†ç±»
- çº¿ç¨‹çš„åˆ›å»ºé€€å‡º
- çº¿ç¨‹çš„å–æ¶ˆ
- çº¿ç¨‹çš„ç»ˆæ­¢æ¸…ç†å‡½æ•°
- 